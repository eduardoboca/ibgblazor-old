@page "/data-import"

<PageTitle>Importar dados Excel</PageTitle>

<h1>Importar Dados</h1>
<div class="container">
  <InputFile OnChange="@LoadFiles" single />
</div>
@if (errors.Count > 0)
{
  <h2>Errors</h2>
  <ul class="text-danger">
    @foreach (var error in errors)
    {
      <li>@error</li>
    }
  </ul>
}

@code {
  private long maxFileSize = 1024 * 1024 * 3;
  private int maxAllowedFiles = 1;
  private List<string> errors = new();

  private async Task LoadFiles(InputFileChangeEventArgs e)
  {
    errors.Clear();
    if (e.FileCount > maxAllowedFiles)
    {
      errors.Add($"Erro: tentativa de fazer upload de arquivos {e.FileCount}, mas apenas arquivos {maxAllowedFiles} s√£o permitidos.");
      return;
    }

    foreach (var file in e.GetMultipleFiles(maxAllowedFiles))
    {

    }
  }
}